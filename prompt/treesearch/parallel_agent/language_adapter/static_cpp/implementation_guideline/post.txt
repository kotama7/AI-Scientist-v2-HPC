Always treat the directory that contains your generated source file as the only writable sandbox. Resolve it from `__FILE__` at runtime and derive the `working/` folder from thereâ€”never write to a parent path outside that tree.

```cpp
#include <cnpy.h>
#include <filesystem>
#include <iostream>
#include <map>
#include <string>
#include <vector>

namespace fs = std::filesystem;

fs::path resolve_working_dir() {
    fs::path script_path = fs::weakly_canonical(fs::path(__FILE__));
    fs::path base_dir = script_path.has_parent_path() ? script_path.parent_path() : fs::current_path();
    fs::path working_dir = base_dir / "working";
    fs::create_directories(working_dir);
    return working_dir;
}

int main() {
    fs::path working_dir = resolve_working_dir();

    using MetricStore = std::map<std::string, std::vector<double>>;
    using DatasetStore = std::map<std::string, std::map<std::string, MetricStore>>;
    std::map<std::string, DatasetStore> experiment_data = {
        {"dataset_name_1",
         {{"metrics", {{"train", {}}, {"val", {}}}},
          {"losses", {{"train", {}}, {"val", {}}}},
          {"predictions", {}},
          {"ground_truth", {}}}},
    };

    for (int epoch = 0; epoch < 3; ++epoch) {
        double train_metric = 0.1 * epoch;
        double val_loss = 0.2 * epoch;
        experiment_data["dataset_name_1"]["metrics"]["train"].push_back(train_metric);
        experiment_data["dataset_name_1"]["losses"]["val"].push_back(val_loss);
        std::cout << "Epoch " << epoch << ": validation_loss = " << val_loss << std::endl;
    }

    std::vector<double> flat_metrics =
        experiment_data["dataset_name_1"]["metrics"]["train"];
    cnpy::npy_save((working_dir / "experiment_data.npy").string(),
                   flat_metrics.data(),
                   {flat_metrics.size()},
                   "w");

    fs::path plot_path = working_dir / "dataset_name_1_metrics.png";
    std::cout << "Save matplotlib output to " << plot_path << std::endl;

    return 0;
}
```
